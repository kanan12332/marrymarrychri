<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <title>åœ£è¯å¿«ä¹</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        body {
            font-family: "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            color: white;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(to bottom, #0a2e1d 0%, #0d3b29 100%);
            touch-action: manipulation;
            -webkit-font-smoothing: antialiased;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        /* èƒŒæ™¯å›¾ç‰‡å®¹å™¨ */
        #background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.8;
        }
        
        #background-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        /* ç¬¬ä¸€é˜¶æ®µï¼šç¤¼ç›’å±å¹• */
        #gift-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(10, 31, 20, 0.3);
            z-index: 3;
        }
        
        /* ç¤¼ç›’å®¹å™¨ */
        .gift-container {
            position: relative;
            width: 200px;
            height: 250px;
            cursor: pointer;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* ç¤¼ç›’å›¾ç‰‡ */
        .gift-image {
            width: 200px;
            height: 200px;
            object-fit: contain;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.5));
            animation: pulse 2s infinite ease-in-out;
            -webkit-user-drag: none;
            user-drag: none;
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: translateY(0) scale(1); 
            }
            50% { 
                transform: translateY(-15px) scale(1.05); 
            }
        }
        
        /* ç¤¼ç›’ç¼©å°åŠ¨ç”» */
        .gift-image.shrink {
            animation: shrink 1.5s ease-out forwards;
        }
        
        @keyframes shrink {
            0% {
                transform: scale(1);
                opacity: 1;
                filter: blur(0px);
            }
            100% {
                transform: scale(0.1);
                opacity: 0.3;
                filter: blur(5px);
            }
        }
        
        /* ç‚¹å‡»å¼•å¯¼ç®­å¤´ - åœ¨ç¤¼ç›’ä¸Šæ–¹ */
        .click-arrow {
            font-size: 50px;
            color: #FFD700;
            animation: arrowBounce 1.5s infinite;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.9);
            margin-bottom: 15px;
            pointer-events: none;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-user-select: none;
            user-select: none;
        }
        
        @keyframes arrowBounce {
            0%, 100% { 
                transform: translateY(0); 
                opacity: 1;
            }
            50% { 
                transform: translateY(-10px); 
                opacity: 0.8;
            }
        }
        
        /* ç‚¹å‡»æç¤ºæ–‡å­— */
        .instruction {
            font-size: 22px;
            color: #FFD700;
            text-align: center;
            padding: 15px 30px;
            background: rgba(196, 30, 58, 0.3);
            border-radius: 30px;
            border: 2px solid #FFD700;
            backdrop-filter: blur(5px);
            margin-top: 10px;
            max-width: 90%;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* çˆ†ç‚¸ç²’å­å®¹å™¨ */
        .explosion-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
        
        /* å½©å¸¦ç²’å­ */
        .ribbon-particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            animation: explode 1s ease-out forwards;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
        }
        
        @keyframes explode {
            0% {
                transform: translate(0, 0) scale(0);
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                transform: translate(var(--dx), var(--dy)) scale(1);
                opacity: 0;
            }
        }
        
        /* åœ£è¯å…ƒç´ ç²’å­ï¼ˆé›ªèŠ±ã€æ˜Ÿæ˜Ÿç­‰ï¼‰ */
        .christmas-particle {
            position: absolute;
            font-size: 24px;
            pointer-events: none;
            animation: explode 1s ease-out forwards;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* ============== é›ªèŠ±æ•ˆæœ ============== */
        /* ä¿®å¤ï¼šé›ªèŠ±å®¹å™¨ç½®é¡¶ï¼Œå…è®¸é®æŒ¡å­—å¹• */
        .snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10000; /* æé«˜åˆ°æœ€é«˜å±‚çº§ */
            overflow: hidden;
        }
        
        .snowflake {
            position: absolute;
            top: -60px;
            pointer-events: none;
            will-change: transform, top, opacity;
            animation: snowFall linear infinite;
            -webkit-user-select: none;
            user-select: none;
            font-size: 24px; /* æ·»åŠ å­—ä½“å¤§å° */
            color: white; /* æ·»åŠ ç™½è‰² */
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.9); /* æ·»åŠ å‘å…‰æ•ˆæœ */
            z-index: 10001; /* ç¡®ä¿é›ªèŠ±åœ¨é¡¶å±‚ */
            filter: blur(0.5px); /* è½»å¾®æ¨¡ç³Šæ•ˆæœ */
        }
        
        @keyframes snowFall {
            0% {
                transform: translateX(0) translateY(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            100% {
                transform: translateX(var(--snow-x, 0)) translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* é›ªèŠ±æ‹–å°¾ç²’å­ */
        .snow-trail {
            position: absolute;
            pointer-events: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            z-index: 10000;
            animation: trailFade 1.5s ease-out forwards;
            filter: blur(1px);
        }
        
        @keyframes trailFade {
            0% {
                opacity: 0.7;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0.2);
            }
        }
        
        /* ============== 10ç§’ç¡¬æ§åŠ¨ç”» ============== */
        .hard-control-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        /* åœ£è¯è€äººé£åˆ°ä¸­é—´åŠ¨ç”» - ä¿®å¤ */
        .santa-flying-center {
            position: fixed;
            width: 200px;
            height: auto;
            z-index: 1001;
            pointer-events: none;
            opacity: 0;
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            -webkit-user-select: none;
            user-select: none;
        }
        
        .santa-flying-center.visible {
            opacity: 1;
            animation: santaFlyToCenter 10s ease-in-out forwards;
        }
        
        @keyframes santaFlyToCenter {
            0% {
                transform: translateX(-50%) scale(0.5);
                opacity: 0;
            }
            10% {
                transform: translateX(-50%) scale(0.8);
                opacity: 0.8;
            }
            20% {
                transform: translateX(-50%) scale(1);
                opacity: 1;
            }
            30% {
                transform: translateX(-50%) scale(1.1);
            }
            40%, 60% {
                transform: translateX(-50%) scale(1);
            }
            70% {
                transform: translateX(-50%) scale(1);
                opacity: 1;
            }
            80% {
                transform: translateX(-50%) scale(0.8);
                opacity: 0.8;
            }
            90% {
                transform: translateX(-50%) scale(0.5);
                opacity: 0.5;
            }
            100% {
                transform: translateX(-50%) scale(0);
                opacity: 0;
            }
        }
        
        /* æ’’ç¤¼ç‰©æ•ˆæœ - ä¿®å¤ */
        .gift-drop-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1002;
        }
        
        .dropped-gift {
            position: absolute;
            font-size: 40px;
            opacity: 0;
            pointer-events: none;
            animation: dropGift 3s ease-out forwards;
            -webkit-user-select: none;
            user-select: none;
        }
        
        @keyframes dropGift {
            0% {
                transform: translate(0, 0) scale(0) rotate(0deg);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            40% {
                transform: translate(var(--gift-x), var(--gift-y)) scale(1) rotate(180deg);
            }
            60% {
                transform: translate(var(--gift-x), var(--gift-y)) scale(1.2) rotate(360deg);
            }
            80% {
                transform: translate(var(--gift-x), var(--gift-y)) scale(0.8) rotate(540deg);
                opacity: 0.8;
            }
            100% {
                transform: translate(var(--gift-x), var(--gift-y)) scale(1) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* ============== åœ£è¯è€äººåŠ¨å›¾ ============== */
        .santa-image {
            position: absolute;
            width: 180px;
            height: auto;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.5));
            z-index: 10;
            opacity: 0;
            pointer-events: none;
            top: 15%;
            -webkit-user-select: none;
            user-select: none;
            display: block !important;
        }
        
        /* ç¤¼ç›’é˜¶æ®µçš„åœ£è¯è€äººï¼ˆä»å·¦åˆ°å³ï¼‰ */
        #santa-opening {
            left: -200px;
            opacity: 0.7;
        }
        
        /* ä¸»ç•Œé¢åœ£è¯è€äºº1ï¼ˆä»å·¦åˆ°å³ï¼‰ */
        .santa-left-to-right {
            left: -200px;
        }
        
        /* ä¸»ç•Œé¢åœ£è¯è€äºº2ï¼ˆä»å³åˆ°å·¦ï¼‰ */
        .santa-right-to-left {
            right: -200px;
            transform: scaleX(-1); /* é•œåƒç¿»è½¬ï¼Œé¢æœå·¦è¾¹ */
        }
        
        .santa-image.visible {
            opacity: 1;
            animation: santaFly 25s linear infinite;
        }
        
        .santa-right-to-left.visible {
            animation: santaFlyReverse 25s linear infinite;
        }
        
        @keyframes santaFly {
            0% {
                transform: translateX(0) translateY(0);
                left: -200px;
            }
            10% {
                transform: translateY(10px);
            }
            20% {
                transform: translateY(-5px);
            }
            30% {
                transform: translateY(8px);
            }
            50% {
                transform: translateY(0);
            }
            70% {
                transform: translateY(6px);
            }
            80% {
                transform: translateY(-3px);
            }
            90% {
                transform: translateY(5px);
            }
            100% {
                transform: translateY(0);
                left: 100vw;
            }
        }
        
        @keyframes santaFlyReverse {
            0% {
                transform: scaleX(-1) translateX(0) translateY(0);
                right: -200px;
            }
            10% {
                transform: scaleX(-1) translateY(10px);
            }
            20% {
                transform: scaleX(-1) translateY(-5px);
            }
            30% {
                transform: scaleX(-1) translateY(8px);
            }
            50% {
                transform: scaleX(-1) translateY(0);
            }
            70% {
                transform: scaleX(-1) translateY(6px);
            }
            80% {
                transform: scaleX(-1) translateY(-3px);
            }
            90% {
                transform: scaleX(-1) translateY(5px);
            }
            100% {
                transform: scaleX(-1) translateY(0);
                right: 100vw;
            }
        }
        
        /* ============== åœ£è¯æ ‘åŒºåŸŸ ============== */
        .tree-container {
            position: absolute;
            bottom: 10%;
            left: 5%;
            width: 280px;
            height: 420px;
            z-index: 5;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .tree-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.6));
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            -webkit-user-select: none;
            user-select: none;
            display: block !important;
        }
        
        .tree-image:hover {
            transform: scale(1.08) rotate(3deg);
            filter: drop-shadow(0 12px 25px rgba(0, 0, 0, 0.7));
        }
        
        /* æ–°å¢ï¼šåœ£è¯æ ‘è·³èˆåŠ¨ç”» - å·¦å³æ‘‡æ‘† */
        .tree-image.dancing {
            animation: treeDance 3s ease-in-out infinite;
        }
        
        @keyframes treeDance {
            0%, 100% { 
                transform: rotate(0deg) translateX(0); 
            }
            25% { 
                transform: rotate(-5deg) translateX(-8px); 
            }
            50% { 
                transform: rotate(0deg) translateX(0); 
            }
            75% { 
                transform: rotate(5deg) translateX(8px); 
            }
        }
        
        .tree-title {
            font-size: 24px;
            color: #FFD700;
            margin-top: 15px;
            text-align: center;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
            font-weight: bold;
            background: rgba(196, 30, 58, 0.3);
            padding: 8px 20px;
            border-radius: 15px;
            border: 2px solid #FFD700;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* åœ£è¯æ ‘è£…é¥°å“ - ä¿®å¤ä½ç½® */
        .ornament {
            position: absolute;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 6;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            -webkit-user-select: none;
            user-select: none;
        }
        
        .ornament:hover {
            transform: scale(1.4);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.4);
            z-index: 7;
        }
        
        /* è£…é¥°å“ç‹¡çŒ¾æ»‘èµ°åŠ¨ç”» */
        .ornament.escaping {
            animation: ornamentEscape 2s ease-out forwards;
            pointer-events: none;
            z-index: 100;
        }
        
        @keyframes ornamentEscape {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            30% {
                transform: translate(var(--escape-x1), var(--escape-y1)) scale(1.2);
                opacity: 0.9;
            }
            60% {
                transform: translate(var(--escape-x2), var(--escape-y2)) scale(0.9);
                opacity: 0.7;
            }
            90% {
                transform: translate(var(--escape-x3), var(--escape-y3)) scale(0.7);
                opacity: 0.5;
            }
            100% {
                transform: translate(var(--escape-x4), var(--escape-y4)) scale(0.5);
                opacity: 0.3;
                pointer-events: auto; /* æ¢å¤ç‚¹å‡»äº‹ä»¶ */
            }
        }
        
        /* è£…é¥°å“å›å½’åŠ¨ç”» */
        .ornament.returning {
            animation: ornamentReturn 1.5s ease-out forwards;
            pointer-events: none;
        }
        
        @keyframes ornamentReturn {
            0% {
                transform: translate(var(--escape-x4), var(--escape-y4)) scale(0.5);
                opacity: 0.3;
            }
            100% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
        }
        
        /* ç¬¬äºŒé˜¶æ®µï¼šä¸»å±å¹• */
        #main-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(10, 31, 20, 0.8);
            backdrop-filter: blur(3px);
            z-index: 2;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* ç¥ç¦è¯­åŒºåŸŸ - ä¿®å¤æ–‡å­—å¯¹é½é—®é¢˜ */
        .blessing-container {
            background: rgba(196, 30, 58, 0.25);
            border-radius: 20px;
            padding: 30px;
            margin: 20px;
            max-width: 700px;
            width: 90%;
            border: 2px solid #FFD700;
            backdrop-filter: blur(10px);
            z-index: 5;
            min-height: 250px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .blessing-title {
            font-size: 28px;
            color: #FFD700;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
            font-weight: bold;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            width: 100%;
        }
        
        /* ä¿®å¤ï¼šæ–‡å­—å¯¹é½å·¥æ•´ï¼Œé¿å…æµä½“è¾“å‡ºæ··ä¹± */
        .blessing-text {
            font-size: 22px;
            line-height: 1.8;
            color: white;
            text-align: center;
            min-height: 180px;
            width: 100%;
            font-family: "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "SimHei", sans-serif;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            padding: 0 10px;
            box-sizing: border-box;
            word-break: keep-all;
            white-space: normal;
            overflow-wrap: break-word;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* æ¯è¡Œç¥ç¦è¯­å®¹å™¨ */
        .blessing-line {
            margin-bottom: 15px;
            width: 100%;
            text-align: center;
            animation: fadeInUp 0.5s ease-out forwards;
            opacity: 0;
            transform: translateY(10px);
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 28px;
            background-color: #FFD700;
            animation: blink 1s infinite;
            vertical-align: middle;
            margin-left: 5px;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        /* åœ£è¯æ ‘é—ªçƒæ•ˆæœ */
        @keyframes treeGlow {
            0%, 100% { filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.6)); }
            50% { filter: drop-shadow(0 8px 25px rgba(255, 215, 0, 0.5)); }
        }
        
        .tree-image.glow {
            animation: treeGlow 2s infinite;
        }
        
        /* æ‰‹åŠ¨æ’­æ”¾æŒ‰é’®æ ·å¼ */
        #manual-play-btn {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000; /* ç¡®ä¿åœ¨é›ªèŠ±ä¹‹ä¸Š */
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            display: none;
        }
        #manual-play-btn.error {
            background: #ff6b6b;
        }
        
        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2001;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 25px;
            border-radius: 10px;
            color: #FFD700;
            font-size: 16px;
            display: none;
            text-align: center;
        }
        
        /* å“åº”å¼è°ƒæ•´ - æ‰‹æœºç«¯ä¼˜åŒ– */
        @media screen and (max-width: 768px) {
            .gift-container {
                width: 180px;
                height: 230px;
            }
            
            .gift-image {
                width: 180px;
                height: 180px;
            }
            
            .click-arrow {
                font-size: 45px;
                margin-bottom: 10px;
                height: 55px;
            }
            
            .instruction {
                font-size: 20px;
                padding: 14px 28px;
                margin: 0 15px;
            }
            
            .santa-image {
                width: 160px;
                top: 10%;
            }
            
            .santa-flying-center {
                width: 180px;
                top: 25%;
            }
            
            .tree-container {
                width: 240px;
                height: 360px;
                left: 3%;
                bottom: 8%;
            }
            
            .tree-title {
                font-size: 22px;
                padding: 6px 16px;
                margin-top: 10px;
            }
            
            .ornament {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
            
            .blessing-container {
                margin: 15px;
                padding: 25px;
                max-width: 90%;
            }
            
            .blessing-title {
                font-size: 26px;
                margin-bottom: 20px;
            }
            
            .blessing-text {
                font-size: 20px;
                line-height: 1.7;
                min-height: 160px;
            }
            
            .dropped-gift {
                font-size: 35px;
            }
            
            #manual-play-btn {
                padding: 10px 20px;
                font-size: 14px;
                bottom: 15px;
            }
        }
        
        @media screen and (max-width: 480px) {
            .gift-container {
                width: 160px;
                height: 210px;
            }
            
            .gift-image {
                width: 160px;
                height: 160px;
            }
            
            .click-arrow {
                font-size: 40px;
                margin-bottom: 8px;
                height: 50px;
            }
            
            .instruction {
                font-size: 18px;
                padding: 12px 24px;
                margin: 0 10px;
            }
            
            .santa-image {
                width: 140px;
                top: 8%;
            }
            
            .santa-flying-center {
                width: 150px;
                top: 20%;
            }
            
            .tree-container {
                width: 200px;
                height: 300px;
                left: 2%;
                bottom: 6%;
            }
            
            .tree-title {
                font-size: 20px;
                padding: 5px 14px;
                margin-top: 8px;
            }
            
            .ornament {
                width: 28px;
                height: 28px;
                font-size: 14px;
            }
            
            .blessing-container {
                margin: 10px;
                padding: 20px;
            }
            
            .blessing-title {
                font-size: 24px;
                margin-bottom: 15px;
            }
            
            .blessing-text {
                font-size: 18px;
                line-height: 1.6;
                min-height: 140px;
            }
            
            .dropped-gift {
                font-size: 30px;
            }
            
            #manual-play-btn {
                padding: 10px 18px;
                font-size: 14px;
            }
        }
        
        @media screen and (orientation: landscape) and (max-height: 600px) {
            .gift-container {
                width: 140px;
                height: 180px;
                margin-bottom: 15px;
            }
            
            .gift-image {
                width: 140px;
                height: 140px;
            }
            
            .click-arrow {
                font-size: 35px;
                margin-bottom: 5px;
                height: 40px;
            }
            
            .instruction {
                font-size: 18px;
                padding: 10px 20px;
                margin-top: 5px;
            }
            
            .tree-container {
                width: 180px;
                height: 270px;
                bottom: 5%;
            }
            
            .blessing-container {
                padding: 15px;
                margin: 10px;
                min-height: 150px;
            }
            
            .blessing-title {
                font-size: 22px;
            }
            
            .blessing-text {
                font-size: 18px;
                min-height: 120px;
            }
            
            #main-screen {
                padding: 10px;
            }
        }
        
        /* é˜²æ­¢é•¿æŒ‰èœå• */
        .no-context-menu {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
        .touch-feedback {
            animation: touchPulse 0.3s ease-out;
        }
        
        @keyframes touchPulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯å›¾ç‰‡ -->
    <div id="background-container">
        <img id="background-image" src="" alt="åœ£è¯èƒŒæ™¯">
    </div>
    
    <!-- é›ªèŠ±å®¹å™¨ - ç°åœ¨åœ¨æœ€å‰é¢ -->
    <div class="snow-container" id="snowContainer"></div>
    
    <!-- ç¬¬ä¸€é˜¶æ®µï¼šç¤¼ç›’ç•Œé¢ -->
    <div id="gift-screen">
        <div class="gift-container" id="giftContainer">
            <!-- ç‚¹å‡»å¼•å¯¼ç®­å¤´ï¼ˆåœ¨ç¤¼ç›’ä¸Šæ–¹ï¼‰ -->
            <div class="click-arrow">ğŸ‘‡</div>
            <img src="" alt="åœ£è¯ç¤¼ç›’" class="gift-image" id="giftImage">
        </div>
        <div class="instruction">ç‚¹å‡»ç¤¼ç›’å¼€å¯åœ£è¯æƒŠå–œ</div>
    </div>
    
    <!-- çˆ†ç‚¸ç²’å­å®¹å™¨ -->
    <div class="explosion-container" id="explosionContainer"></div>
    
    <!-- 10ç§’ç¡¬æ§è¦†ç›–å±‚ -->
    <div class="hard-control-overlay" id="hardControlOverlay"></div>
    
    <!-- åœ£è¯è€äººé£åˆ°ä¸­é—´åŠ¨ç”» -->
    <img class="santa-flying-center" id="santaFlyingCenter" src="" alt="åœ£è¯è€äºº">
    
    <!-- æ’’ç¤¼ç‰©å®¹å™¨ -->
    <div class="gift-drop-container" id="giftDropContainer"></div>
    
    <!-- åœ£è¯è€äººå›¾ç‰‡ - ç¤¼ç›’é˜¶æ®µ -->
    <img class="santa-image" id="santaOpening" src="" alt="åœ£è¯è€äºº">
    
    <!-- ç¬¬äºŒé˜¶æ®µï¼šä¸»ç•Œé¢ -->
    <div id="main-screen">
        <!-- ç¥ç¦è¯­åŒºåŸŸ -->
        <div class="blessing-container">
            <h2 class="blessing-title">ğŸ„ MerryChristmasï¼ğŸ„</h2>
            <div class="blessing-text" id="blessingText">
                <!-- æ‰“å­—æœºæ•ˆæœä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºæ–‡å­— -->
            </div>
        </div>
        
        <!-- åœ£è¯æ ‘åŒºåŸŸ -->
        <div class="tree-container">
            <img src="" alt="åœ£è¯æ ‘" class="tree-image" id="christmasTree">
            <div class="tree-title">ç‚¹å‡»è£…é¥°å“å’Œå®ƒä»¬ç©æ‰è¿·è—</div>
        </div>
        
        <!-- åœ£è¯è€äººå›¾ç‰‡ - ä¸»ç•Œé¢é˜¶æ®µï¼ˆä»å·¦åˆ°å³ï¼‰ -->
        <img class="santa-image santa-left-to-right" id="santaMain1" src="" alt="åœ£è¯è€äºº">
        
        <!-- åœ£è¯è€äººå›¾ç‰‡ - ä¸»ç•Œé¢é˜¶æ®µï¼ˆä»å³åˆ°å·¦ï¼‰ -->
        <img class="santa-image santa-right-to-left" id="santaMain2" src="" alt="åœ£è¯è€äºº">
    </div>

    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div class="loading-indicator" id="loadingIndicator">åŠ è½½ç´ æä¸­...</div>

    <!-- æ‰‹åŠ¨æ’­æ”¾æŒ‰é’® -->
    <button id="manual-play-btn">ğŸµ ç‚¹æ­¤å¼€å¯èƒŒæ™¯éŸ³ä¹</button>

    <!-- éŸ³é¢‘å…ƒç´  -->
    <audio id="openingMusic" preload="auto">
        <source src="" type="audio/mpeg">
    </audio>
    
    <audio id="mainMusic" preload="auto">
        <source src="" type="audio/mpeg">
    </audio>

    <script>
        // ============== é…ç½®åŒº ==============
        
        // é‡è¦ï¼šåœ¨è¿™é‡Œè®¾ç½®æ‚¨çš„ç´ æè·¯å¾„ï¼
        const ASSETS_CONFIG = {
            images: {
                background: [
                    'assets/images/background.jpg',
                    'assets/images/background.jpeg',
                    'assets/images/background.png',
                    'background.jpg',
                    'background.jpeg',
                    'background.png'
                ],
                giftBox: [
                    'assets/images/gift-box.png',
                    'assets/images/gift-box.jpg',
                    'assets/images/gift-box.jpeg',
                    'gift-box.png',
                    'gift-box.jpg'
                ],
                christmasTree: [
                    'assets/images/christmas-tree.png',
                    'assets/images/christmas-tree.jpg',
                    'assets/images/christmas-tree.jpeg',
                    'christmas-tree.png',
                    'christmas-tree.jpg'
                ],
                santaFallback: [
                    'santa-fallback.png',
                    'assets/images/santa-fallback.png',
                    'assets/images/santa-fallback.jpg'
                ]
            },
            
            audio: {
                opening: [
                    'assets/audio/opening.mp3',
                    'assets/audio/opening.m4a',
                    'opening.mp3'
                ],
                main: [
                    'assets/audio/main.mp3',
                    'assets/audio/main.m4a',
                    'main.mp3'
                ]
            }
        };
        
        // ç¥ç¦è¯­æ•°ç»„
         const blessings = [
            "ğŸ… ç¥æ‚¨åœ¨åœ£è¯èŠ‚æ¯ä¸€å¤©éƒ½å……æ»¡ç€æ¬¢ä¹ï¼",
            "âœ¨ Wishing you and your loved ones a season of harmony, joy, and good healthï¼",
            "ğŸ”” æ„¿åœ£è¯çš„é’Ÿå£°èƒ½å¸¦æ¥loveï¼†peaceï¼",
            "ğŸ¦Œ æ„¿æ‚¨åœ¨è¿™ä¸ªç‰¹åˆ«çš„èŠ‚æ—¥é‡Œï¼Œæ”¶è·æ»¡æ»¡çš„å¿«ä¹ä¸å®‰åº·ï¼",
            "ğŸ‰ æœ€åç¥åå”å”å’Œæ˜å§¨åœ£è¯å¿«ä¹ï¼Œæ–°å¹´å¿«ä¹ï¼",
        ];

        
        // å½©å¸¦é¢œè‰²
        const ribbonColors = ['#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0', '#118AB2', '#EF476F'];
        
        // åœ£è¯å…ƒç´ æ•°ç»„
        const christmasElements = ['â„ï¸', 'ğŸ„', 'â­', 'ğŸ', 'ğŸ…', 'ğŸ¦Œ', 'ğŸ””', 'ğŸ•¯ï¸', 'ğŸª', 'â˜ƒï¸'];
        
        // è£…é¥°å“é¢œè‰²
        const ornamentColors = ['#FF6B6B', '#FFD166', '#06D6A0', '#118AB2', '#EF476F', '#FF9A8B'];
        
        // è£…é¥°å“å†…å®¹
        const ornamentContents = ['ğŸ„', 'ğŸ', 'â­', 'ğŸ””', 'ğŸ•¯ï¸', 'ğŸ¬', 'â„ï¸', 'ğŸ€'];
        
        // ============== è·å–å…ƒç´  ==============
        const giftScreen = document.getElementById('gift-screen');
        const mainScreen = document.getElementById('main-screen');
        const giftImage = document.getElementById('giftImage');
        const explosionContainer = document.getElementById('explosionContainer');
        const giftContainer = document.getElementById('giftContainer');
        const backgroundImage = document.getElementById('background-image');
        const clickArrow = document.querySelector('.click-arrow');
        const santaOpening = document.getElementById('santaOpening');
        const santaMain1 = document.getElementById('santaMain1');
        const santaMain2 = document.getElementById('santaMain2');
        const santaFlyingCenter = document.getElementById('santaFlyingCenter');
        const snowContainer = document.getElementById('snowContainer');
        const openingMusic = document.getElementById('openingMusic');
        const mainMusic = document.getElementById('mainMusic');
        const blessingText = document.getElementById('blessingText');
        const christmasTree = document.getElementById('christmasTree');
        const treeContainer = document.querySelector('.tree-container');
        const hardControlOverlay = document.getElementById('hardControlOverlay');
        const giftDropContainer = document.getElementById('giftDropContainer');
        const manualPlayBtn = document.getElementById('manual-play-btn');
        const loadingIndicator = document.getElementById('loadingIndicator');
        
        // ============== çŠ¶æ€å˜é‡ ==============
        let isGiftOpened = false;
        let isOpeningAudioPlaying = false;
        let isMainAudioPlaying = false;
        let hardControlTimeout;
        let ornamentsData = [];
        let bgmPlayAttempted = false;
        let loadedAssets = 0;
        let totalAssets = 0;
        let snowStarted = false; // é›ªèŠ±æ˜¯å¦å·²å¼€å§‹
        let snowflakes = []; // å­˜å‚¨é›ªèŠ±å¯¹è±¡
        
        // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨ç«¯
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // ============== è¾…åŠ©å‡½æ•°ï¼šå°è¯•åŠ è½½å¤šä¸ªè·¯å¾„ ==============
        
        function tryLoadAsset(element, urls, onSuccess, onError) {
            if (!urls || urls.length === 0) {
                onError();
                return;
            }
            
            let currentIndex = 0;
            
            function tryNext() {
                if (currentIndex >= urls.length) {
                    onError();
                    return;
                }
                
                const url = urls[currentIndex];
                console.log(`å°è¯•åŠ è½½: ${url}`);
                
                if (element.tagName === 'IMG') {
                    const img = new Image();
                    img.onload = function() {
                        console.log(`å›¾ç‰‡åŠ è½½æˆåŠŸ: ${url}`);
                        element.src = url;
                        onSuccess();
                    };
                    img.onerror = function() {
                        console.log(`å›¾ç‰‡åŠ è½½å¤±è´¥: ${url}`);
                        currentIndex++;
                        tryNext();
                    };
                    img.src = url;
                } 
                else if (element.tagName === 'AUDIO') {
                    const source = element.querySelector('source');
                    if (source) {
                        source.src = url;
                        element.load();
                        
                        element.onloadeddata = function() {
                            console.log(`éŸ³é¢‘åŠ è½½æˆåŠŸ: ${url}`);
                            onSuccess();
                        };
                        
                        element.onerror = function() {
                            console.log(`éŸ³é¢‘åŠ è½½å¤±è´¥: ${url}`);
                            currentIndex++;
                            tryNext();
                        };
                    } else {
                        currentIndex++;
                        tryNext();
                    }
                }
            }
            
            tryNext();
        }
        
        // ============== ç´ æåŠ è½½å‡½æ•° ==============
        
        function loadAllAssets() {
            showLoading();
            
            totalAssets = 7; // å¢åŠ äº†åœ£è¯è€äººå›¾ç‰‡
            
            // åŠ è½½èƒŒæ™¯å›¾ç‰‡
            tryLoadAsset(
                backgroundImage,
                ASSETS_CONFIG.images.background,
                function() {
                    console.log('èƒŒæ™¯å›¾ç‰‡åŠ è½½æˆåŠŸ');
                    backgroundImage.style.display = 'block';
                    assetLoaded();
                },
                function() {
                    console.warn('æ‰€æœ‰èƒŒæ™¯å›¾ç‰‡è·¯å¾„éƒ½å¤±è´¥ï¼Œä½¿ç”¨çº¯è‰²èƒŒæ™¯');
                    document.getElementById('background-container').style.background = 'linear-gradient(to bottom, #0a2e1d 0%, #0d3b29 100%)';
                    assetLoaded();
                }
            );
            
            // åŠ è½½ç¤¼ç›’å›¾ç‰‡
            tryLoadAsset(
                giftImage,
                ASSETS_CONFIG.images.giftBox,
                function() {
                    console.log('ç¤¼ç›’å›¾ç‰‡åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('æ‰€æœ‰ç¤¼ç›’å›¾ç‰‡è·¯å¾„éƒ½å¤±è´¥ï¼Œä½¿ç”¨Emoji');
                    giftImage.style.display = 'none';
                    const emojiGift = document.createElement('div');
                    emojiGift.style.fontSize = '120px';
                    emojiGift.style.animation = 'pulse 2s infinite ease-in-out';
                    emojiGift.style.textAlign = 'center';
                    emojiGift.style.marginTop = '20px';
                    emojiGift.textContent = 'ğŸ';
                    emojiGift.classList.add('no-context-menu');
                    giftContainer.appendChild(emojiGift);
                    assetLoaded();
                }
            );
            
            // åŠ è½½åœ£è¯æ ‘å›¾ç‰‡
            tryLoadAsset(
                christmasTree,
                ASSETS_CONFIG.images.christmasTree,
                function() {
                    console.log('åœ£è¯æ ‘å›¾ç‰‡åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('æ‰€æœ‰åœ£è¯æ ‘å›¾ç‰‡è·¯å¾„éƒ½å¤±è´¥ï¼Œä½¿ç”¨Emoji');
                    christmasTree.style.display = 'none';
                    const emojiTree = document.createElement('div');
                    emojiTree.style.fontSize = '200px';
                    emojiTree.style.animation = 'pulse 2s infinite ease-in-out';
                    emojiTree.style.textAlign = 'center';
                    emojiTree.textContent = 'ğŸ„';
                    emojiTree.classList.add('no-context-menu');
                    treeContainer.insertBefore(emojiTree, treeContainer.firstChild);
                    assetLoaded();
                }
            );
            
            // åŠ è½½åœ£è¯è€äººå›¾ç‰‡ï¼ˆå¼€åœºï¼‰
            tryLoadAsset(
                santaOpening,
                ASSETS_CONFIG.images.santaFallback,
                function() {
                    console.log('å¼€åœºåœ£è¯è€äººå›¾ç‰‡åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('æ‰€æœ‰åœ£è¯è€äººå›¾ç‰‡è·¯å¾„éƒ½å¤±è´¥');
                    santaOpening.style.display = 'none';
                    assetLoaded();
                }
            );
            
            // åŠ è½½é£è¡Œåœ£è¯è€äººå›¾ç‰‡
            tryLoadAsset(
                santaFlyingCenter,
                ASSETS_CONFIG.images.santaFallback,
                function() {
                    console.log('é£è¡Œåœ£è¯è€äººå›¾ç‰‡åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('é£è¡Œåœ£è¯è€äººå›¾ç‰‡åŠ è½½å¤±è´¥');
                    santaFlyingCenter.style.display = 'none';
                    assetLoaded();
                }
            );
            
            // åŠ è½½ä¸»ç•Œé¢åœ£è¯è€äººå›¾ç‰‡1
            tryLoadAsset(
                santaMain1,
                ASSETS_CONFIG.images.santaFallback,
                function() {
                    console.log('ä¸»ç•Œé¢åœ£è¯è€äºº1å›¾ç‰‡åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('ä¸»ç•Œé¢åœ£è¯è€äºº1å›¾ç‰‡åŠ è½½å¤±è´¥');
                    santaMain1.style.display = 'none';
                    assetLoaded();
                }
            );
            
            // åŠ è½½ä¸»ç•Œé¢åœ£è¯è€äººå›¾ç‰‡2
            tryLoadAsset(
                santaMain2,
                ASSETS_CONFIG.images.santaFallback,
                function() {
                    console.log('ä¸»ç•Œé¢åœ£è¯è€äºº2å›¾ç‰‡åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('ä¸»ç•Œé¢åœ£è¯è€äºº2å›¾ç‰‡åŠ è½½å¤±è´¥');
                    santaMain2.style.display = 'none';
                    assetLoaded();
                }
            );
            
            // åŠ è½½å¼€åœºéŸ³é¢‘
            tryLoadAsset(
                openingMusic,
                ASSETS_CONFIG.audio.opening,
                function() {
                    console.log('å¼€åœºéŸ³é¢‘åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('æ‰€æœ‰å¼€åœºéŸ³é¢‘è·¯å¾„éƒ½å¤±è´¥');
                    assetLoaded();
                }
            );
            
            // åŠ è½½ä¸»ç•Œé¢éŸ³é¢‘
            tryLoadAsset(
                mainMusic,
                ASSETS_CONFIG.audio.main,
                function() {
                    console.log('ä¸»ç•Œé¢éŸ³é¢‘åŠ è½½æˆåŠŸ');
                    assetLoaded();
                },
                function() {
                    console.warn('æ‰€æœ‰ä¸»ç•Œé¢éŸ³é¢‘è·¯å¾„éƒ½å¤±è´¥');
                    assetLoaded();
                }
            );
        }
        
        function assetLoaded() {
            loadedAssets++;
            console.log(`å·²åŠ è½½ ${loadedAssets}/${totalAssets} ä¸ªèµ„æº`);
            
            if (loadedAssets >= totalAssets) {
                hideLoading();
                initPage();
            }
        }
        
        function showLoading() {
            loadingIndicator.style.display = 'block';
        }
        
        function hideLoading() {
            setTimeout(() => {
                loadingIndicator.style.display = 'none';
                console.log('æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ');
            }, 500);
        }
        
        // ============== é¡µé¢åˆå§‹åŒ– ==============
        
        function initPage() {
            console.log('é¡µé¢åˆå§‹åŒ–å¼€å§‹');
            
            // æ˜¾ç¤ºç¤¼ç›’é˜¶æ®µçš„åœ£è¯è€äºº
            santaOpening.classList.add('visible');
            
            // å¼€å§‹é›ªèŠ±æ•ˆæœ
            if (!snowStarted) {
                startSnow();
                snowStarted = true;
            }
            
            console.log('é¡µé¢åˆå§‹åŒ–å®Œæˆ');
        }
        
        // ============== éŸ³é¢‘æ ¸å¿ƒé€»è¾‘ ==============
        
        function preloadAudio() {
            openingMusic.muted = true;
            mainMusic.muted = true;
            openingMusic.preload = 'auto';
            mainMusic.preload = 'auto';
            
            const loadPromise1 = openingMusic.play();
            if (loadPromise1 !== undefined) {
                loadPromise1.then(() => {
                    openingMusic.pause();
                    console.log('å¼€åœºéŸ³é¢‘é¢„åŠ è½½æˆåŠŸ');
                }).catch(e => {
                    console.log('å¼€åœºéŸ³é¢‘é¢„åŠ è½½è¢«é˜»æ­¢');
                });
            }
            
            const loadPromise2 = mainMusic.play();
            if (loadPromise2 !== undefined) {
                loadPromise2.then(() => {
                    mainMusic.pause();
                    console.log('ä¸»ç•Œé¢éŸ³é¢‘é¢„åŠ è½½æˆåŠŸ');
                }).catch(e => {
                    console.log('ä¸»ç•Œé¢éŸ³é¢‘é¢„åŠ è½½è¢«é˜»æ­¢');
                });
            }
            
            openingMusic.muted = false;
            mainMusic.muted = false;
        }
        
        function playOpeningMusic() {
            if (bgmPlayAttempted) return;
            
            bgmPlayAttempted = true;
            openingMusic.currentTime = 0;
            
            const playPromise = openingMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    console.log('å¼€åœºéŸ³ä¹æ’­æ”¾æˆåŠŸ');
                    manualPlayBtn.style.display = 'none';
                    isOpeningAudioPlaying = true;
                }).catch(error => {
                    console.warn('å¼€åœºéŸ³ä¹è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:', error);
                    showManualPlayButton();
                });
            }
        }
        
        function playMainMusic() {
            if (isOpeningAudioPlaying) {
                openingMusic.pause();
                openingMusic.currentTime = 0;
                isOpeningAudioPlaying = false;
            }
            
            mainMusic.currentTime = 0;
            
            const playPromise = mainMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    console.log('ä¸»ç•Œé¢éŸ³ä¹æ’­æ”¾æˆåŠŸ');
                    manualPlayBtn.style.display = 'none';
                    isMainAudioPlaying = true;
                }).catch(error => {
                    console.warn('ä¸»ç•Œé¢éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
                    showManualPlayButton();
                });
            }
        }
        
        function showManualPlayButton() {
            manualPlayBtn.style.display = 'block';
            manualPlayBtn.textContent = 'ğŸµ ç‚¹æ­¤å¼€å¯èƒŒæ™¯éŸ³ä¹';
            manualPlayBtn.classList.remove('error');
        }
        
        manualPlayBtn.addEventListener('click', function() {
            if (isOpeningAudioPlaying || isMainAudioPlaying) {
                if (isOpeningAudioPlaying) {
                    openingMusic.muted = !openingMusic.muted;
                    this.textContent = openingMusic.muted ? 'ğŸ”‡ å–æ¶ˆé™éŸ³' : 'ğŸ”Š éŸ³ä¹æ’­æ”¾ä¸­';
                } else if (isMainAudioPlaying) {
                    mainMusic.muted = !mainMusic.muted;
                    this.textContent = mainMusic.muted ? 'ğŸ”‡ å–æ¶ˆé™éŸ³' : 'ğŸ”Š éŸ³ä¹æ’­æ”¾ä¸­';
                }
            } else {
                if (isGiftOpened) {
                    mainMusic.play().then(() => {
                        this.style.display = 'none';
                    }).catch(e => {
                        this.textContent = 'ğŸµ æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®';
                        this.classList.add('error');
                    });
                } else {
                    openingMusic.play().then(() => {
                        this.style.display = 'none';
                    }).catch(e => {
                        this.textContent = 'ğŸµ æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®';
                        this.classList.add('error');
                    });
                }
            }
        });
        
        // ============== é›ªèŠ±æ•ˆæœ - å¢å¼ºç‰ˆï¼ˆå¸¦æ‹–å°¾å’Œæ—‹è½¬ï¼‰==============
        
        function startSnow() {
            console.log('å¼€å§‹é›ªèŠ±æ•ˆæœ');
            
            // æ¸…ç©ºç°æœ‰é›ªèŠ±å®¹å™¨
            snowContainer.innerHTML = '';
            snowflakes = [];
            
            // åˆ›å»ºé›ªèŠ±æ‹–å°¾ç²’å­
            function createSnowTrail(x, y, size, opacity, color = 'rgba(255, 255, 255, 0.6)') {
                const trail = document.createElement('div');
                trail.className = 'snow-trail';
                
                // éšæœºå¤§å°
                const trailSize = size * (0.3 + Math.random() * 0.4);
                trail.style.width = trailSize + 'px';
                trail.style.height = trailSize + 'px';
                
                // éšæœºä½ç½®åç§»
                const offsetX = (Math.random() - 0.5) * 10;
                const offsetY = (Math.random() - 0.5) * 10;
                
                trail.style.left = (x + offsetX) + 'px';
                trail.style.top = (y + offsetY) + 'px';
                trail.style.backgroundColor = color;
                trail.style.opacity = opacity * 0.7;
                
                // éšæœºåŠ¨ç”»æ—¶é•¿
                const animationDuration = 800 + Math.random() * 700;
                trail.style.animationDuration = animationDuration + 'ms';
                
                // æ·»åŠ æ‹–å°¾ç²’å­åˆ°å®¹å™¨
                snowContainer.appendChild(trail);
                
                // åŠ¨ç”»ç»“æŸåç§»é™¤æ‹–å°¾ç²’å­
                setTimeout(() => {
                    if (trail.parentNode) {
                        trail.remove();
                    }
                }, animationDuration);
            }
            
            // åˆ›å»ºé›ªèŠ±
            function createSnowflake() {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                
                // ä½¿ç”¨Emojié›ªèŠ±
                snowflake.textContent = 'â„ï¸';
                
                // éšæœºå¤§å°
                const size = isMobile ? 20 : 24 + Math.random() * 12;
                snowflake.style.fontSize = size + 'px';
                
                // éšæœºæ°´å¹³ä½ç½®
                const leftPos = Math.random() * 100;
                snowflake.style.left = leftPos + '%';
                
                // éšæœºé€æ˜åº¦
                const opacity = 0.7 + Math.random() * 0.3;
                snowflake.style.opacity = opacity;
                
                // éšæœºæ°´å¹³æ¼‚ç§»è·ç¦»
                const xDrift = Math.random() * 60 - 30;
                snowflake.style.setProperty('--snow-x', `${xDrift}px`);
                
                // éšæœºä¸‹è½é€Ÿåº¦å’Œæ—‹è½¬
                const fallDuration = isMobile ? 10000 : 8000 + Math.random() * 7000;
                snowflake.style.animationDuration = `${fallDuration}ms`;
                
                // éšæœºå»¶è¿Ÿå¼€å§‹
                const delay = Math.random() * 5;
                snowflake.style.animationDelay = `${delay}s`;
                
                // æ·»åŠ åˆ°å®¹å™¨
                snowContainer.appendChild(snowflake);
                
                // åˆ›å»ºé›ªèŠ±æ•°æ®å¯¹è±¡
                const snowflakeData = {
                    element: snowflake,
                    size: size,
                    opacity: opacity,
                    lastTrailTime: Date.now(),
                    trailInterval: 150 + Math.random() * 100, // éšæœºæ‹–å°¾é—´éš”
                    xDrift: xDrift,
                    rotationSpeed: 0.5 + Math.random() * 1.5 // éšæœºæ—‹è½¬é€Ÿåº¦
                };
                
                snowflakes.push(snowflakeData);
                
                // é›ªèŠ±åŠ¨ç”»ç»“æŸåé‡æ–°åˆ›å»º
                setTimeout(() => {
                    if (snowflake.parentNode) {
                        snowflake.remove();
                    }
                    
                    // ä»æ•°ç»„ä¸­ç§»é™¤
                    const index = snowflakes.indexOf(snowflakeData);
                    if (index > -1) {
                        snowflakes.splice(index, 1);
                    }
                    
                    // åˆ›å»ºæ–°çš„é›ªèŠ±
                    createSnowflake();
                }, (fallDuration + delay * 1000));
                
                return snowflakeData;
            }
            
            // æ›´æ–°é›ªèŠ±ä½ç½®å’Œåˆ›å»ºæ‹–å°¾
            function updateSnowflakes() {
                const currentTime = Date.now();
                
                snowflakes.forEach(snowflake => {
                    if (currentTime - snowflake.lastTrailTime > snowflake.trailInterval) {
                        // è·å–é›ªèŠ±å½“å‰ä½ç½®
                        const rect = snowflake.element.getBoundingClientRect();
                        const x = rect.left + rect.width / 2;
                        const y = rect.top + rect.height / 2;
                        
                        // åˆ›å»ºæ‹–å°¾ç²’å­
                        createSnowTrail(x, y, snowflake.size, snowflake.opacity);
                        
                        // å¶å°”åˆ›å»ºå½©è‰²æ‹–å°¾
                        if (Math.random() > 0.8) {
                            const colors = ['rgba(173, 216, 230, 0.5)', 'rgba(224, 255, 255, 0.5)', 'rgba(135, 206, 250, 0.5)'];
                            const randomColor = colors[Math.floor(Math.random() * colors.length)];
                            createSnowTrail(x, y, snowflake.size * 0.8, snowflake.opacity * 0.5, randomColor);
                        }
                        
                        snowflake.lastTrailTime = currentTime;
                    }
                });
                
                // ç»§ç»­æ›´æ–°
                requestAnimationFrame(updateSnowflakes);
            }
            
            // åˆ›å»ºåˆå§‹é›ªèŠ±
            const snowflakeCount = isMobile ? 30 : 50;
            
            for (let i = 0; i < snowflakeCount; i++) {
                setTimeout(() => {
                    createSnowflake();
                }, i * 150); // é”™å¼€åˆ›å»ºæ—¶é—´
            }
            
            // å¼€å§‹æ›´æ–°å¾ªç¯
            updateSnowflakes();
        }
        
        // ============== 10ç§’ç¡¬æ§åŠ¨ç”» ==============
        
        function startHardControl() {
            console.log("å¼€å§‹10ç§’ç¡¬æ§åŠ¨ç”»ï¼");
            
            hardControlOverlay.style.display = 'flex';
            
            santaFlyingCenter.classList.add('visible');
            
            setTimeout(() => {
                dropGifts();
            }, 2000);
            
            hardControlTimeout = setTimeout(() => {
                endHardControl();
            }, 10000);
        }
        
        function dropGifts() {
            const giftTypes = ['ğŸ', 'ğŸ„', 'â­', 'ğŸ””', 'ğŸ€', 'ğŸ¬', 'ğŸª', 'ğŸ¦Œ'];
            const dropCount = isMobile ? 15 : 20;
            
            for (let i = 0; i < dropCount; i++) {
                setTimeout(() => {
                    createGiftDrop(giftTypes[i % giftTypes.length]);
                }, i * 300);
            }
        }
        
        function createGiftDrop(giftType) {
            const gift = document.createElement('div');
            gift.className = 'dropped-gift';
            gift.textContent = giftType;
            
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2 - 100;
            
            gift.style.left = `${centerX}px`;
            gift.style.top = `${centerY}px`;
            
            const angle = Math.random() * Math.PI * 2;
            const distance = isMobile ? 100 : 150 + Math.random() * 250;
            
            const x = Math.cos(angle) * distance;
            const y = Math.sin(angle) * distance;
            
            gift.style.setProperty('--gift-x', `${x}px`);
            gift.style.setProperty('--gift-y', `${y}px`);
            
            giftDropContainer.appendChild(gift);
            
            setTimeout(() => {
                if (gift.parentNode) {
                    gift.remove();
                }
            }, 3000);
        }
        
        function endHardControl() {
            console.log("10ç§’ç¡¬æ§ç»“æŸï¼Œåˆ‡æ¢åˆ°ä¸»å±å¹•ï¼");
            
            hardControlOverlay.style.display = 'none';
            
            santaFlyingCenter.classList.remove('visible');
            
            giftDropContainer.innerHTML = '';
            
            giftScreen.style.display = "none";
            mainScreen.style.display = "flex";
            
            santaMain1.classList.add('visible');
            santaMain2.classList.add('visible');
            
            playMainMusic();
            
            // æ–°å¢ï¼šä¸ºä¸»ç•Œé¢çš„åœ£è¯æ ‘æ·»åŠ è·³èˆåŠ¨ç”»
            christmasTree.classList.add('dancing');
            
            setupTreeInteraction();
            createOrnaments();
            
            typeWriterEffect();
        }
        
        // ============== åœ£è¯æ ‘äº¤äº’ ==============
        
        function createOrnaments() {
            const existingOrnaments = treeContainer.querySelectorAll('.ornament');
            existingOrnaments.forEach(ornament => ornament.remove());
            ornamentsData = [];
            
            const ornamentPositions = [
                {top: '12%', left: '48%'},
                {top: '22%', left: '38%'},
                {top: '22%', left: '58%'},
                {top: '32%', left: '32%'},
                {top: '32%', left: '48%'},
                {top: '32%', left: '64%'},
                {top: '45%', left: '42%'},
                {top: '45%', left: '54%'},
                {top: '58%', left: '46%'},
                {top: '58%', left: '52%'},
                {top: '70%', left: '48%'},
            ];
            
            ornamentPositions.forEach((pos, index) => {
                const ornament = document.createElement('div');
                ornament.className = 'ornament';
                ornament.dataset.id = index;
                ornament.dataset.originalTop = pos.top;
                ornament.dataset.originalLeft = pos.left;
                ornament.classList.add('no-context-menu');
                
                ornament.style.top = pos.top;
                ornament.style.left = pos.left;
                ornament.style.backgroundColor = ornamentColors[index % ornamentColors.length];
                ornament.style.boxShadow = `0 0 15px ${ornamentColors[index % ornamentColors.length]}`;
                
                ornament.textContent = ornamentContents[index % ornamentContents.length];
                
                ornamentsData.push({
                    id: index,
                    element: ornament,
                    originalTop: pos.top,
                    originalLeft: pos.left,
                    isEscaping: false,
                    isReturning: false
                });
                
                ornament.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const ornamentId = parseInt(this.dataset.id);
                    const ornamentInfo = ornamentsData.find(o => o.id === ornamentId);
                    
                    if (ornamentInfo.isEscaping || ornamentInfo.isReturning) {
                        return;
                    }
                    
                    ornamentInfo.isEscaping = true;
                    this.classList.add('escaping');
                    
                    const escapeX1 = -Math.random() * 80 - 40;
                    const escapeY1 = -Math.random() * 60 - 30;
                    
                    const escapeX2 = escapeX1 + Math.random() * 120 + 60;
                    const escapeY2 = escapeY1 + Math.random() * 100 + 50;
                    
                    const escapeX3 = escapeX2 - Math.random() * 80 - 40;
                    const escapeY3 = escapeY2 - Math.random() * 50 - 25;
                    
                    const screenEdge = Math.random() > 0.5 ? 1 : -1;
                    const escapeX4 = screenEdge * (Math.random() * 80 + 150);
                    const escapeY4 = Math.random() > 0.5 ? 
                        Math.random() * 80 + 40 : 
                        -Math.random() * 80 - 40;
                    
                    this.style.setProperty('--escape-x1', `${escapeX1}px`);
                    this.style.setProperty('--escape-y1', `${escapeY1}px`);
                    this.style.setProperty('--escape-x2', `${escapeX2}px`);
                    this.style.setProperty('--escape-y2', `${escapeY2}px`);
                    this.style.setProperty('--escape-x3', `${escapeX3}px`);
                    this.style.setProperty('--escape-y3', `${escapeY3}px`);
                    this.style.setProperty('--escape-x4', `${escapeX4}px`);
                    this.style.setProperty('--escape-y4', `${escapeY4}px`);
                    
                    createStarEffect(this, 8);
                    
                    setTimeout(() => {
                        if (this.parentNode && this.classList.contains('escaping')) {
                            ornamentInfo.isEscaping = false;
                            ornamentInfo.isReturning = true;
                            this.classList.remove('escaping');
                            this.classList.add('returning');
                            
                            this.style.setProperty('--escape-x4', `${escapeX4}px`);
                            this.style.setProperty('--escape-y4', `${escapeY4}px`);
                            
                            setTimeout(() => {
                                if (this.parentNode) {
                                    this.classList.remove('returning');
                                    ornamentInfo.isReturning = false;
                                    
                                    this.style.transform = 'translate(0, 0)';
                                    this.style.top = ornamentInfo.originalTop;
                                    this.style.left = ornamentInfo.originalLeft;
                                    
                                    createStarEffect(this, 6);
                                }
                            }, 1500);
                        }
                    }, 2000);
                });
                
                treeContainer.appendChild(ornament);
            });
        }
        
        function createStarEffect(element, count = 8) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const star = document.createElement('div');
                    star.textContent = 'âœ¨';
                    star.style.position = 'fixed';
                    star.style.left = `${centerX}px`;
                    star.style.top = `${centerY}px`;
                    star.style.fontSize = '20px';
                    star.style.zIndex = '20';
                    star.style.pointerEvents = 'none';
                    star.classList.add('no-context-menu');
                    
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 30 + Math.random() * 50;
                    
                    document.body.appendChild(star);
                    
                    const animation = star.animate([
                        { 
                            transform: 'translate(0, 0) scale(0)', 
                            opacity: 1 
                        },
                        { 
                            transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(1.5)`, 
                            opacity: 0 
                        }
                    ], {
                        duration: 800,
                        easing: 'ease-out'
                    });
                    
                    animation.onfinish = () => {
                        if (star.parentNode) {
                            star.remove();
                        }
                    };
                }, i * 50);
            }
        }
        
        function setupTreeInteraction() {
            // åœ£è¯æ ‘ç‚¹å‡»æ—‹è½¬æ•ˆæœ
            let treeRotation = 0;
            let isRotating = false;
            
            christmasTree.addEventListener('click', function() {
                if (isRotating) return;
                isRotating = true;
                
                // æš‚åœè·³èˆåŠ¨ç”»
                this.classList.remove('dancing');
                
                treeRotation += 120 + Math.random() * 120;
                
                this.style.transition = 'transform 1.2s cubic-bezier(0.34, 1.56, 0.64, 1)';
                this.style.transform = `rotate(${treeRotation}deg)`;
                
                const rect = this.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                
                for (let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        createStarEffect({getBoundingClientRect: () => ({
                            left: centerX,
                            top: centerY,
                            width: 0,
                            height: 0
                        })}, 5);
                    }, i * 50);
                }
                
                setTimeout(() => {
                    this.style.transition = '';
                    this.style.transform = '';
                    // æ¢å¤è·³èˆåŠ¨ç”»
                    this.classList.add('dancing');
                    isRotating = false;
                }, 1200);
            });
        }
        
        // ============== æ‰“å­—æœºæ•ˆæœ - ä¼˜åŒ–ç‰ˆ ==============
        
        async function typeWriterEffect() {
            const textElement = blessingText;
            textElement.innerHTML = '';
            
            for (let i = 0; i < blessings.length; i++) {
                const sentence = blessings[i];
                
                // åˆ›å»ºæ¯è¡Œå®¹å™¨
                const lineDiv = document.createElement('div');
                lineDiv.className = 'blessing-line';
                lineDiv.style.animationDelay = `${i * 0.2}s`;
                textElement.appendChild(lineDiv);
                
                // æ·»åŠ æ‰“å­—æœºæ•ˆæœ
                for (let j = 0; j < sentence.length; j++) {
                    lineDiv.textContent += sentence[j];
                    await new Promise(r => setTimeout(r, 80 + Math.random() * 40));
                }
                
                // æ¯å¥ä¹‹é—´çš„åœé¡¿
                await new Promise(r => setTimeout(r, 600));
            }
        }
        
        // ============== ç¤¼ç›’ç‚¹å‡»äº‹ä»¶ ==============
        
        giftContainer.addEventListener('click', openGift);
        document.querySelector('.instruction').addEventListener('click', openGift);
        
        function openGift() {
            if (isGiftOpened) return;
            isGiftOpened = true;
            
            console.log("ç¤¼ç›’è¢«ç‚¹å‡»äº†ï¼");
            
            playOpeningMusic();
            
            santaOpening.classList.remove('visible');
            
            clickArrow.style.display = 'none';
            
            giftImage.classList.add('shrink');
            
            setTimeout(() => {
                createRibbonExplosion();
                createChristmasElements();
            }, 800);
            
            setTimeout(() => {
                startHardControl();
            }, 1500);
        }
        
        function createRibbonExplosion() {
            const rect = giftContainer.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2 - 30;
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'ribbon-particle';
                
                const size = 8 + Math.random() * 15;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                const color = ribbonColors[Math.floor(Math.random() * ribbonColors.length)];
                particle.style.backgroundColor = color;
                
                const angle = Math.random() * Math.PI * 2;
                const distance = 80 + Math.random() * 150;
                
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                
                particle.style.setProperty('--dx', `${x}px`);
                particle.style.setProperty('--dy', `${y}px`);
                
                particle.style.left = `${centerX}px`;
                particle.style.top = `${centerY}px`;
                
                explosionContainer.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.remove();
                    }
                }, 1000);
            }
        }
        
        function createChristmasElements() {
            const rect = giftContainer.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2 - 30;
            
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('div');
                particle.className = 'christmas-particle';
                
                const element = christmasElements[Math.floor(Math.random() * christmasElements.length)];
                particle.textContent = element;
                
                const size = 0.8 + Math.random() * 0.4;
                particle.style.fontSize = `${size}em`;
                
                const angle = Math.random() * Math.PI * 2;
                const distance = 100 + Math.random() * 180;
                
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                
                particle.style.setProperty('--dx', `${x}px`);
                particle.style.setProperty('--dy', `${y}px`);
                
                particle.style.left = `${centerX}px`;
                particle.style.top = `${centerY}px`;
                
                explosionContainer.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.remove();
                    }
                }, 1000);
            }
        }
        
        // ============== é¡µé¢åŠ è½½ ==============
        
        window.addEventListener('load', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
            
            // ç«‹å³å¼€å§‹é›ªèŠ±æ•ˆæœï¼Œä¸ç­‰å¾…å…¶ä»–èµ„æº
            if (!snowStarted) {
                startSnow();
                snowStarted = true;
            }
            
            // ç„¶ååŠ è½½å…¶ä»–èµ„æº
            loadAllAssets();
            
            preloadAudio();
        });
        
        window.addEventListener('resize', function() {
            if (ornamentsData.length > 0) {
                ornamentsData.forEach(ornamentInfo => {
                    if (ornamentInfo.element && ornamentInfo.element.parentNode) {
                        ornamentInfo.element.style.top = ornamentInfo.originalTop;
                        ornamentInfo.element.style.left = ornamentInfo.originalLeft;
                        ornamentInfo.element.style.transform = 'translate(0, 0)';
                    }
                });
            }
        });
        
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) event.preventDefault();
            lastTouchEnd = now;
        }, false);
        
        console.log("è„šæœ¬åˆå§‹åŒ–å®Œæˆ");
    </script>
</body>
</html>